# 業者支払表・総合振込ファイル作成システム

## 概要
このシステムは、業者への支払表作成と銀行の総合振込ファイル生成を効率化するWebアプリケーションです。

## 主な機能

### 1. 業者支払表作成
- 支払日と送金会社名の設定
- 業者選択、金額、摘要、備考の入力
- 支払項目の一覧表示と合計金額計算
- 支払表の保存

### 2. 総合振込ファイル生成
- 業者の口座情報を自動取得
- 銀行システム対応のCSVファイル出力
- Shift_JIS形式での出力（銀行システム対応）

### 銀行システム対応
- **総合振込ファイル**: 完全な銀行仕様準拠
- **預金種目**: 普通口座(1)・当座口座(2)の正確な判定
- **半角カナ変換**: 委託者名・受取人名の正確な変換
- **同一口座合算**: 重複口座の自動統合
- **エラー回避**: Shift_JISエンコード完全対応

## 技術仕様

- **Backend**: Python Flask 2.3.3
- **Frontend**: HTML5, CSS3, JavaScript, Bootstrap 5
- **データ処理**: openpyxl, pandas, ReportLab
- **文字エンコーディング**: Shift_JIS（銀行システム対応）
- **データ保存**: JSON形式

## 必要な環境

- Python 3.7以上
- Flask 2.3.3
- その他の依存関係は requirements.txt を参照

## インストール・起動

1. **依存関係をインストール**
   ```bash
   pip install -r requirements.txt
   ```

2. **アプリケーションを起動**
   ```bash
   python app.py
   ```

3. **ブラウザでアクセス**
   ```
   http://localhost:5000
   ```

## 使用方法

### 1. 業者情報の登録
- **手動登録**: 業者管理セクションで個別に登録
- **一括アップロード**: CSV・Excelファイルからマスターデータを一括登録

### 2. 支払表の作成
1. 支払日と送金会社名を入力
2. 業者を選択し、金額・摘要を入力
3. 「支払表を作成」ボタンでPDF自動生成
4. 「追加」ボタンで支払項目を追加
5. 「支払表作成」ボタンで保存

### 総合振込ファイル生成
1. 支払表作成後、「振込ファイル」ボタンをクリック
2. CSVファイルがダウンロードされます

## ファイル構成
```
keiri/
├── app.py              # メインアプリケーション
├── requirements.txt    # 依存関係
├── README.md          # このファイル
├── templates/
│   └── index.html     # HTMLテンプレート
├── static/
│   ├── css/
│   │   └── style.css  # スタイルシート
│   └── js/
│       └── app.js     # JavaScript
├── vendors.json       # 業者データ（自動生成）
└── payments.json      # 支払データ（自動生成）
```

## 総合振込ファイル形式
生成されるCSVファイルには以下の項目が含まれます：
- 振込日
- 振込依頼人名
- 受取人名
- 受取人口座番号
- 受取人銀行名
- 受取人支店名
- 預金種目
- 振込金額
- 摘要

## 注意事項
- データはJSONファイルに保存されます
- 本番環境では適切なデータベースの使用を推奨します
- 総合振込ファイルは銀行システムに対応したShift_JIS形式で出力されます
